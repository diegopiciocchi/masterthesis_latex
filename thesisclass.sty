%% thesisclass.sty
%% Copyright 2022 D.Piciocchi
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status 'maintained'.
% 
% The Current Maintainer of this work is D. Piciocchi.
%
% This work consists of the files masterthesis.cls, thesisclass.sty,
% Master_Thesis.tex, Bibliography.bib, glossary.tex, compilepdf.sh,
% the Chapters folder containing titlepage.tex, titlepage.pdf,
% abstract.tex, acknowledgements.tex, instructions.tex
% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%% PACKAGES FILE %%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Language and input packages 

\RequirePackage[T1]{fontenc} 
\RequirePackage[utf8]{inputenc} %Package for utf 8 bit encoding
\RequirePackage[british]{babel}
\RequirePackage{csquotes}
\RequirePackage{kantlipsum} % A simply useless package
\RequirePackage{pdfpages}

% Micro-typographic adjustments

\RequirePackage[
    protrusion=true,
    activate={true,nocompatibility},
    final,
    tracking=true,
    kerning=true,
    spacing=true]{microtype}
\SetTracking{encoding={*}}{10}
\UseMicrotypeSet{normalfont}
%\UseMicrotypeSet{allmath}

% Math and physics packages

\RequirePackage{amsthm} % AMS theorem themes etc
\RequirePackage{mathrsfs} % scr fonts for maths
\RequirePackage{amsmath} % Setup Theorems according to ams
\RequirePackage{mathtools} %extends and improves amsmath
\RequirePackage{empheq} % Highlighting equations
\RequirePackage{amsfonts} % Fonts for mathematics
\RequirePackage{amssymb}
\RequirePackage{physics} %physics stuff like bra, ket, ...
\RequirePackage{siunitx} % SI units (you can declare more)

% Tables and figure packages 

\RequirePackage{graphicx}
\RequirePackage{sidecap} % For figures with caption on the side 
\RequirePackage[tableposition=top]{caption} % Caption customisaiton
\RequirePackage{array}
\RequirePackage{tabularx}
\RequirePackage{booktabs}
\RequirePackage{pgfplots}

\RequirePackage{tikz} % For plots with tikz
\usetikzlibrary{shapes, decorations, calc, arrows}
\usetikzlibrary{3d,fit,backgrounds, decorations.text}
\usetikzlibrary{positioning, shapes.symbols}
\usetikzlibrary{decorations.pathreplacing, calligraphy}
\tikzset{>=latex}

% Typesetting packages and others 

\RequirePackage{kantlipsum} % A simply useless package
\RequirePackage{changepage}
\RequirePackage{silence}
\WarningFilter{latex}{Writing or overwriting file} % silences a warning when overwriting metadata file

%Package for calculations
\RequirePackage{calc}


% Bibliography

\RequirePackage[
    %style=numeric-comp,
	%citestyle=authortitle-icomp,
	citestyle=numeric-comp,
	%bibstyle=authoryear,
	bibstyle=numeric,
	%sorting=none,
	sorting=nyt,
	sortcites=true,
	%autocite=footnote,
	backend=biber, % Compile the bibliography with biber
	hyperref=true,
	backref=true,
	citecounter=true,
	citetracker=true,
	ibidtracker=context,
    ]{biblatex}

% Here you should do some fine tuning of the bibliographic entries
\AtEveryBibitem{
	\clearfield{issn}
	\clearfield{doi}
	\clearfield{isbn}
	\clearfield{archivePrefix}
	\clearfield{arxivId}
	\clearfield{pmid}
	\clearfield{eprint}
	\ifentrytype{online}{}{\ifentrytype{misc}{}{\clearfield{url}}}
	\ifentrytype{book}{\clearfield{doi}}{}
}

% Package to make this file PDF/A compliant. You can choose between levels of compliance from 1 to 4. Sadly, only b level files can be produced. The University of Trento requires 1. Notice that this package also loads hyperref and xcolor. No need to call them. Options for them can be called separately. The mathxmp option is important.
% This package may cause problems with bookmarks when using mathematical symbols in titles of sections and stuff. 
\RequirePackage[a-1b,mathxmp]{pdfx}[2018/12/22]

% \RequirePackage{hyperref}
% \RequirePackage{xcolor}

\hypersetup{
	colorlinks=true,
	linkcolor=black,
	urlcolor=cyan,
} 

\RequirePackage[open, openlevel=1]{bookmark}

\RequirePackage[acronym, toc]{glossaries} % This makes the glossary


%%% SETTINGS FOR PAGE LAYOUT

% Read carefully the manual in order to be able to customise the margins! 

% This settings is suggested for a4paper on the memoir manual

\settrimmedsize{297mm}{210mm}{*}
\setlength{\trimtop}{0pt}
\setlength{\trimedge}{\stockwidth}
\addtolength{\trimedge}{-\paperwidth}

%\settypeblocksize{634pt}{448.13pt}{*} % Default, wide, but not bad looking!

% Palatino, 12 pt should have this length to have the (ideal) number of 66 average characters per line in the text. It may however cause overfull problems on some lines, like 1.5 per page. You maybe could avoid it with some care!

%\settypeblocksize{634pt}{342.0pt}{*} % about 65 char per line
%\settypeblocksize{634pt}{360.13pt}{*} % about 69 char per line
% \settypeblocksize{634pt}{372.13pt}{*} % about 70.5 char per line

% Using \lxvchars to set 66 characters
\setlxvchars[\normalfont\normalsize]
\settypeblocksize{634pt}{1.015384615\lxvchars}{*}

% Setting Margins
\setulmargins{4cm}{*}{*}
\setlrmargins{*}{*}{1.6}
\setmarginnotes{17pt}{51pt}{\onelineskip} % default
\setheadfoot{\onelineskip}{2\onelineskip}
\setheaderspaces{*}{2\onelineskip}{*}
\checkandfixthelayout

%%% FONT SELECTION

\renewcommand{\familydefault}{ppl} % palatino
%\renewcommand{\familydefault}{put} % utopia
%\renewcommand{\familydefault}{ptm} % times


%%% CHAPTER TITLE LAYOUT

% If none of them fully satisfies your taste, you can think of building a custom one.

%\chapterstyle{companion}
%\chapterstyle{demo}
%\chapterstyle{bianchi}
%\chapterstyle{demo2}
%\chapterstyle{demo3}
%\chapterstyle{ell}
%\chapterstyle{ger}
\chapterstyle{madsen}
%\chapterstyle{veelo}

%% Make custom chapter style


%%% SETTING DEPTH OF NUMBERING AND TOC ITEMS

\setsecnumdepth{subsection}
\settocdepth{subsection}

%%% OTHER SETTINGS

% This increases the line spacing by 7%
% Delete this in case the document gets too long, the default spacing is not bad after all.

\DisemulatePackage{setspace}
\RequirePackage{setspace}
\setstretch{1.07}


%% Make a new figure command whose extension into the wide margin can be customised by the user 

% Takes as input 1) pos specifier 2) size parameter 3) file name 5) label 5) caption for lof 6) caption 


\newcommand{\printfigure}[6]{%
	\begin{figure}[#1]
		\begin{center}
		\checkoddpage
		\ifoddpage
			\addtolength{\rightskip}{-#2}
		\else
			\addtolength{\leftskip}{-#2}
		\fi
		\includegraphics[width=\textwidth + #2]{#3}
		\end{center}
		\label{#4}
		\caption[#5]{#6}
	\end{figure} }
	
	
% Listing for the instruction manual
\RequirePackage{listings}
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{red},
  keywordstyle=\color{blue}
}


